<!DOCTYPE html>
<html>
    <head>
        <title>Leaderboard</title>
        <link rel="stylesheet" type="text/css" href="styles.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Jua&family=Luckiest+Guy&display=swap" rel="stylesheet">
    </head>
    <body>
        <h1>Wall Street Tycoon Leaderboards</h1>
        <div class="leaderboards-container">
            <div class="leaderboard">
                <h2 class="dark-blue-bg">The Dot-Com Boom</h2>
                <table id="minigame1">
                <tr>
                    <th>Time Stamp</th>
                    <th>Player</th>
                    <th>Score</th>
                </tr>
                </table>
            </div>

            <div class="leaderboard">
                <h2 class="dark-blue-bg">The Crypto Rise</h2>
                <table id="minigame2">
                <tr>
                    <th>Time Stamp</th>
                    <th>Player</th>
                    <th>Score</th></tr>
                </table>
            </div>

            <div class="leaderboard">
                <h2 class="dark-blue-bg">The AI Revolution</h2>
                <table id="minigame3">
                <tr>
                    <th>Time Stamp</th>
                    <th>Player</th>
                    <th>Score</th>
                </tr>
                </table>
            </div>
        </div>

        <script>
const scriptUrl = "https://script.google.com/macros/s/AKfycbwuDgCY7I3RpQQVuiN1WSG0D3kRUeVOFoq4XZkEJXxk11lBSvodFUnS57C_QxInqcLy/exec";

function loadLeaderboard(minigame, tableId) {
  fetch(`${scriptUrl}?game=${minigame}`)
    .then(res => res.json())
    .then(data => {
      const table = document.getElementById(tableId);
      table.innerHTML = "<tr><th>Time Stamp</th><th>Player</th><th>Score</th></tr>";
      data.forEach((row, index) => {
        const tr = document.createElement("tr");

        if(index === 0) {
          tr.classList.add("top-score");
        } else if(index === 1) {
          tr.classList.add("second-score");
        } else if(index === 2) {
          tr.classList.add("third-score");
        }
        tr.innerHTML = `
          <td>${new Date(row.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</td>
          <td>${row.username}</td>
          <td>${formatScore(row)}</td>`;
        table.appendChild(tr);
      });
    })
    .catch(err => console.error("Error:", err));
}

function formatScore(row) {
  switch(row.minigame) {
    case "minigame1":   // money
      return `$${Number(row.score).toFixed(2)}`; // e.g., $1200.50
    case "minigame2":   // seconds
    case "minigame3":
      return `${row.score} s`;                  // e.g., 45 s
    default:
      return row.score;
  }
}

// Load all minigames immediately
loadLeaderboard('minigame1', 'minigame1');
loadLeaderboard('minigame2', 'minigame2');
loadLeaderboard('minigame3', 'minigame3');

// Refresh periodically
setInterval(() => {
  loadLeaderboard('minigame1', 'minigame1');
  loadLeaderboard('minigame2', 'minigame2');
  loadLeaderboard('minigame3', 'minigame3');
}, 5000); // refresh every 5 seconds
</script>
    </body>
</html>