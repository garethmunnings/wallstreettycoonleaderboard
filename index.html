<!DOCTYPE html>
<html>
    <head>
        <title>Leaderboard</title>
        <link rel="stylesheet" type="text/css" href="styles.css">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Luckiest+Guy&family=Open+Sans:ital,wght@0,300..800;1,300..800&display=swap" rel="stylesheet">
    </head>
    <body>
        <div class="leaderboards-container">
            <div class="leaderboard">
                <h2 class="dark-blue-bg">The Dot-Com Boom</h2>
                <table id="minigame1" border="1">
                <tr><th>Time Stamp</th><th>Player</th><th>Score</th></tr>
                </table>
            </div>

            <div class="leaderboard">
                <h2 class="dark-blue-bg">The Crypto Rise</h2>
                <table id="minigame2" border="1">
                <tr><th>Time Stamp</th><th>Player</th><th>Score</th></tr>
                </table>
            </div>

            <div class="leaderboard">
                <h2 class="dark-blue-bg">The AI Revolution</h2>
                <table id="minigame3" border="1">
                <tr><th>Time Stamp</th><th>Player</th><th>Score</th></tr>
                </table>
            </div>
        </div>

        <script>
const scriptUrl = "https://script.google.com/macros/s/AKfycbzTkXzmBDQnire8iaBmc2bvC3HC30DowBsFli8hZfffiOMivUQScRxdj8mQ7O_im3fn/exec";

function loadLeaderboard(minigame, tableId) {
  fetch(`${scriptUrl}?game=${minigame}`)
    .then(res => res.json())
    .then(data => {
      const table = document.getElementById(tableId);
      table.innerHTML = "<tr><th>Time Stamp</th><th>Player</th><th>Score</th></tr>";
      data.forEach(row => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${new Date(row.timestamp).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}</td>
          <td>${row.username}</td>
          <td>${row.score}</td>`;
        table.appendChild(tr);
      });
    })
    .catch(err => console.error("Error:", err));
}

// Load all minigames immediately
loadLeaderboard('minigame1', 'minigame1');
loadLeaderboard('minigame2', 'minigame2');
loadLeaderboard('minigame3', 'minigame3');

// Refresh periodically
setInterval(() => {
  loadLeaderboard('minigame1', 'minigame1');
  loadLeaderboard('minigame2', 'minigame2');
  loadLeaderboard('minigame3', 'minigame3');
}, 5000); // refresh every 5 seconds
</script>
    </body>
</html>